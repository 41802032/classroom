<% submit_url = local_assigns.fetch(:submit_url) %>
<% query = local_assigns.fetch(:query, nil) %>
<% search_placeholder = local_assigns.fetch(:search_placeholder, "Search...") %>
<% sort_menu_title = local_assigns.fetch(:sort_menu_title, "Sort by:") %>
<% view_menu_title = local_assigns.fetch(:view_menu_title, "View:") %>
<% sort_options = local_assigns.fetch(:sort_options, []) %>
<% view_options = local_assigns.fetch(:view_options, []) %>
<% sort_option_links = local_assigns.fetch(:sort_option_links, []) %>
<% view_option_links = local_assigns.fetch(:view_option_links, []) %>
<% active_sort_option = local_assigns.fetch(:active_sort_option, sort_options.first) %>
<% active_view_option = local_assigns.fetch(:active_view_option, view_options.first) %>

<%= form_tag submit_url, method: :get, remote: :true, role: "search", class: "d-block d-sm-flex" do %>
  <div class="mb-3 mb-md-0 mr-md-3 flex-auto">
    <input type="search" id="your-classrooms-filter" name="query"
           class="form-control width-full js-autosearch-field"
           placeholder="Find a classroom&hellip;"
           aria-label="Find a classroom&hellip;"
           value="<%= query %>">
  </div>

  <div class="d-flex">
    <% if archive_classrooms_enabled? %>
      <details class="details-reset details-overlay position-relative mr-2" id="view-options">
        <summary class="btn select-menu-button mt-0">
          <i>View:</i>
          <span data-menu-button>
            <%= active_view_option %>
          </span>
        </summary>

        <details-menu class="select-menu-modal hx_rsm-modal position-absolute right-0" style="z-index: 99;">
          <div class="select-menu-header text-left">
            <span class="select-menu-title">View</span>
            <button class="btn-link close-button" type="button" data-toggle-for="type-options"><%= octicon("x", :"aria-label" => "Close menu") %></button>
          </div>
          <div class="select-menu-list">
            <% view_options.each do |name, value| %>
              <label class="select-menu-item" role="menuitemradio" aria-checked="<%= active_view_option == name %>" tabindex="0">
                <%= radio_button_tag "view", value, active_view_option == value %>
                <%= octicon("check", class: "select-menu-item-icon") %>
                <span class="text-normal select-menu-item-text" data-menu-button-text><%= name %></span>
              </label>
            <% end %>
          </div>
        </details-menu>
      </details>
    <% end %>

    <details class="details-reset details-overlay position-relative flex-auto" id="view-options">
      <summary class="btn select-menu-button mt-0">
        <i>Sort by:</i>
        <span data-menu-button>
          <%= active_sort_option %>
        </span>
      </summary>

      <details-menu class="select-menu-modal hx_rsm-modal position-absolute right-0" style="z-index: 99;">
        <div class="select-menu-header text-left">
          <span class="select-menu-title">Sort by:</span>
          <button class="btn-link close-button" type="button" data-toggle-for="type-options"><%= octicon("x", :"aria-label" => "Close menu") %></button>
        </div>
        <div class="select-menu-list">
          <% sort_options.each do |name, value| %>
            <label class="select-menu-item" role="menuitemradio" aria-checked="<%= active_sort_option == name %>" tabindex="0">
              <%= radio_button_tag "sort_by", value, active_sort_option == value %>
              <%= octicon("check", class: "select-menu-item-icon") %>
              <span class="text-normal select-menu-item-text" data-menu-button-text><%= name %></span>
            </label>
          <% end %>
        </div>
      </details-menu>
    </details>

    <%= link_to new_organization_path, class: 'text-center btn btn-primary ml-3', role: 'button' do %>
      <%= t('views.organizations.new_classroom') %>
    <% end %>
  </div>
<% end %>
